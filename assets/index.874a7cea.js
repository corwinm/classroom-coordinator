import{j as x,E as k,r as L,R as j,a as D}from"./vendor.02f8e31f.js";const O=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function d(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function n(e){if(e.ep)return;e.ep=!0;const t=d(e);fetch(e.href,t)}};O();const o=x.exports.jsx,R=x.exports.jsxs;function C(){return o("header",{children:o("h1",{children:"Classroom Coordinator"})})}function E(l){const r=new FileReader;return r.readAsArrayBuffer(l),r.onload=async()=>{var y;if(!r.result||typeof r.result=="string"){alert("Failed to load file");return}const n=await new k.Workbook().xlsx.load(r.result);console.log(`Found worksheets: ${n.worksheets.map(p=>p.name)}`);const e=n.worksheets.find(p=>p.name.toLowerCase()==="rotation");e==null||e.spliceRows(3,6),(y=e==null?void 0:e.getRows(25,6))==null||y.forEach((p,a)=>{var v,b;for(const u of[2,3,4]){const f=e.getCell(a+25,u),i=e.getCell(a+32,u);if(i.style=f.style,[2,4].includes(u)){if(a===0){const[s,h]=(b=(v=f.value)==null?void 0:v.toString().split(" "))!=null?b:[],g=new Date(h);g.setDate(g.getDate()+7),i.value=`${s} ${g.toLocaleDateString()}`}else if(a===1){let s=0;for(;f.value&&!i.value&&s<5;){const h=e.getCell(30-s,u);i.value=h.value,s+=1}}else if(f.value){const s=e.getCell(a+24,u);i.value=s.value}continue}i.value=f.value}});const t=await n.xlsx.writeBuffer(),c=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=window.URL.createObjectURL(c),m=document.createElement("a");m.href=w,m.download="test.xlsx",m.click(),window.URL.revokeObjectURL(w)},null}function F(){const l=L.exports.useRef(null);return R("form",{noValidate:!0,onSubmit:d=>{var n;if(d.preventDefault(),((n=l.current)==null?void 0:n.files)&&l.current.files.length){console.log(`Found ${l.current.files.length} files`);const e=l.current.files[0];E(e)}},children:[o("label",{htmlFor:"original-xl",children:"Original Excel Document"}),o("br",{}),o("input",{id:"original-xl",type:"file",ref:l,accept:".xlsx"}),o("hr",{}),o("button",{type:"submit",children:"Process Document"})]})}function S(){return R("div",{className:"App",children:[o(C,{}),o(F,{})]})}j.render(o(D.StrictMode,{children:o(S,{})}),document.getElementById("root"));
