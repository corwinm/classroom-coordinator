var q=Object.defineProperty,K=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var U=(e,t,r)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E=(e,t)=>{for(var r in t||(t={}))I.call(t,r)&&U(e,r,t[r]);if(R)for(var r of R(t))T.call(t,r)&&U(e,r,t[r]);return e},H=(e,t)=>K(e,_(t));var P=(e,t)=>{var r={};for(var l in e)I.call(e,l)&&t.indexOf(l)<0&&(r[l]=e[l]);if(e!=null&&R)for(var l of R(e))t.indexOf(l)<0&&T.call(e,l)&&(r[l]=e[l]);return r};import{j as $,e as z,r as N,R as G,a as J}from"./vendor.3647ac4e.js";const Q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}};Q();const s=$.exports.jsx,y=$.exports.jsxs,V=$.exports.Fragment;function Y(){return s("header",{className:"bg-white border-b-2 border-gray-200",children:s("h1",{className:"text-2xl text-gray-900 py-5 px-4",children:"Classroom Coordinator"})})}function M(e){var t;return((t=e.value)==null?void 0:t.toString().split(" ")[1].split("/").slice(0,2).join("-"))||"N/A"}function Z(e,t,r){return`${e.substring(0,e.indexOf("rotation")+8)} ${t} to ${r}`}const S=24,j=29,B=31,w=2,W=3,v=4,ee="No School";function te(e,{tuesdayHoliday:t,thursdayHoliday:r,noSchoolText:l=ee}){return new Promise((a,n)=>{const u=new FileReader;u.readAsArrayBuffer(e),u.onload=async()=>{if(!u.result||typeof u.result=="string"){n("Failed to load file");return}let h,o;try{h=await new z.exports.Workbook().xlsx.load(u.result),console.log(`Found worksheets: ${h.worksheets.map(c=>c.name)}`),o=h.worksheets.find(c=>c.name.toLowerCase()==="rotation")}catch(d){n("Failed to read Excel doc. Check uploaded document and try again.");return}if(!o){n("Couldn't find worksheet named 'Rotation'");return}o.spliceRows(2,7);let g={[w]:S,[W]:S,[v]:S},p={[w]:j,[W]:j,[v]:j};const i=o.getRows(S,6);for(const d of[w,v]){let c=!1;do c=!1,i==null||i.forEach((A,D)=>{if(c)return;const k=o==null?void 0:o.getCell(D+g[d],d);(k==null?void 0:k.value)===l&&(c=!0,g[d]=g[d]-7,p[d]=p[d]-7)});while(c)}i==null||i.forEach((d,c)=>{var D,k;if(!o){n("Couldn't find worksheet named 'Rotation'");return}const A=o.getRow(c+B);A.height=d.height;for(const m of[w,W,v]){const F=o.getCell(c+g[m],m),b=o.getCell(c+B,m);if(b.style=F.style,[w,v].includes(m)){if(c===0){const x=o.getCell(c+S,m),[L,X]=(k=(D=x.value)==null?void 0:D.toString().split(" "))!=null?k:[],O=new Date(X);O.setDate(O.getDate()+7),b.value=`${L} ${O.toLocaleDateString()}`}else if(m===w&&t||m===v&&r)b.value=c===3?"No School":"";else if(c===1){let x=0;for(;F.value&&!b.value&&x<5;){const L=o.getCell(p[m]-x,m);b.value=L.value,x+=1}}else if(F.value){const x=o.getCell(c+g[m]-1,m);b.value=x.value}continue}b.value=F.value}});const f=M(o.getCell(3,w)),C=M(o.getCell(B,v));h.title=Z(e.name,f,C),a(h)}})}async function oe(e){const t=await e.xlsx.writeBuffer(),r=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(r),a=document.createElement("a");a.href=l,a.download=e.title,a.click(),window.URL.revokeObjectURL(l)}const re=(u,n)=>{var h=u,{id:e,label:t,accept:r,onChange:l}=h,a=P(h,["id","label","accept","onChange"]);const[o,g]=N.exports.useState(null),[p,i]=N.exports.useState(!1);return y(V,{children:[s("label",{htmlFor:e,className:"leading-8",children:t}),y("div",{className:`relative px-4 py-8 border-dashed border-gray-500 border-4 text-center hover:bg-gray-200 ${p&&"bg-blue-200"}`,children:[o===null?y("div",{children:["Drag file here or"," ",s("span",{className:"text-blue-600 underline",children:"select a file"})]}):o,s("input",H(E({type:"file",ref:n,id:e,accept:r},a),{style:{textIndent:"-999em"},onChange:f=>{var C,d;g(((d=(C=f.target.files)==null?void 0:C[0])==null?void 0:d.name)||null),l==null||l(f)},onDragEnter:f=>i(!0),onDragLeave:f=>i(!1),onDragEnd:f=>i(!1),onDrop:f=>i(!1),className:"absolute top-0 left-0 w-full h-full cursor-pointer text-transparent"}))]})]})};var le=N.exports.forwardRef(re);const ae=()=>{const[e,t]=N.exports.useState({workbook:null,originalXl:null,tuesdayHoliday:!1,thursdayHoliday:!1}),{tuesdayHoliday:r,thursdayHoliday:l,workbook:a,originalXl:n}=e;return N.exports.useEffect(()=>{(async()=>{if(n)try{const o=await te(n,{tuesdayHoliday:r,thursdayHoliday:l});t(H(E({},e),{workbook:o}))}catch(o){o instanceof Error&&alert(o.message)}})()},[n,r,l]),{formState:e,onSubmit:o=>{o.preventDefault(),a&&oe(a)},onChange:o=>{var i,f;const g=o.target.name||o.target.id;let p;switch(o.target.type){case"file":{p=(f=(i=o.target)==null?void 0:i.files)==null?void 0:f.item(0);break}case"checkbox":p=o.target.checked;break}t(H(E({},e),{[g]:p}))}}};function ne(){const{formState:{workbook:e,tuesdayHoliday:t,thursdayHoliday:r},onChange:l,onSubmit:a}=ae();return s("div",{className:"m-4",children:y("form",{onSubmit:a,className:"max-w-lg mx-auto bg-white border-gray-200 border-2 rounded-md p-2",children:[s("legend",{className:"text-xl leading-10",children:"Class Rotation"}),s(le,{id:"originalXl",label:"Original Excel Document",accept:".xlsx",onChange:l,required:!0}),y("fieldset",{className:"my-2",children:[s("legend",{className:"text-xl leading-10",children:"Holiday?"}),y("div",{children:[s("input",{type:"checkbox",id:"tuesdayHoliday",checked:t,onChange:l}),s("label",{htmlFor:"tuesdayHoliday",className:"mx-1",children:"Tuesday"})]}),y("div",{children:[s("input",{type:"checkbox",id:"thursdayHoliday",checked:r,onChange:l}),s("label",{htmlFor:"thursdayHoliday",className:"mx-1",children:"Thursday"})]})]}),s("div",{className:"text-center",children:y("button",{type:"submit",className:"bg-green-600 hover:bg-green-800 text-white p-4 text-center mt-4 mb-2",children:["Download ",e==null?void 0:e.title]})})]})})}console.log(`Build timestamp: ${new Date("Sun Oct 24 23:05:56 PDT 2021").toLocaleString()}`);function se(){return y("div",{className:"App",children:[s(Y,{}),s(ne,{})]})}G.render(s(J.StrictMode,{children:s(se,{})}),document.getElementById("root"));
