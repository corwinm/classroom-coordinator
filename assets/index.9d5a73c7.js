var j=Object.defineProperty,O=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var F=(e,t,o)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,L=(e,t)=>{for(var o in t||(t={}))D.call(t,o)&&F(e,o,t[o]);if(y)for(var o of y(t))C.call(t,o)&&F(e,o,t[o]);return e},E=(e,t)=>O(e,$(t));var S=(e,t)=>{var o={};for(var r in e)D.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&y)for(var r of y(e))t.indexOf(r)<0&&C.call(e,r)&&(o[r]=e[r]);return o};import{j as k,E as A,r as v,R as I,a as U}from"./vendor.02f8e31f.js";const B=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}};B();const s=k.exports.jsx,w=k.exports.jsxs,M=k.exports.Fragment;function q(){return s("header",{className:"bg-white border-b-2 border-gray-200",children:s("h1",{className:"text-2xl text-gray-900 py-5 px-4",children:"Classroom Coordinator"})})}function P(e){const t=new FileReader;return t.readAsArrayBuffer(e),t.onload=async()=>{var x;if(!t.result||typeof t.result=="string"){alert("Failed to load file");return}let o,r;try{o=await new A.Workbook().xlsx.load(t.result),console.log(`Found worksheets: ${o.worksheets.map(l=>l.name)}`),r=o.worksheets.find(l=>l.name.toLowerCase()==="rotation")}catch(m){alert("Failed to read Excel doc. Check uploaded document and try again.");return}if(!r){alert("Couldn't find worksheet named 'Rotation'");return}r.spliceRows(2,7),(x=r.getRows(24,6))==null||x.forEach((m,l)=>{var g,p;if(!r){alert("Couldn't find worksheet named 'Rotation'");return}const c=r.getRow(l+32);c.height=m.height;for(const h of[2,3,4]){const b=r.getCell(l+24,h),f=r.getCell(l+31,h);if(f.style=b.style,[2,4].includes(h)){if(l===0){const[d,R]=(p=(g=b.value)==null?void 0:g.toString().split(" "))!=null?p:[],N=new Date(R);N.setDate(N.getDate()+7),f.value=`${d} ${N.toLocaleDateString()}`}else if(l===1){let d=0;for(;b.value&&!f.value&&d<5;){const R=r.getCell(30-d,h);f.value=R.value,d+=1}}else if(b.value){const d=r.getCell(l+24,h);f.value=d.value}continue}f.value=b.value}});const n=await o.xlsx.writeBuffer(),a=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=window.URL.createObjectURL(a),u=document.createElement("a");u.href=i,u.download=e.name,u.click(),window.URL.revokeObjectURL(i)},null}const H=(a,n)=>{var i=a,{id:e,label:t,accept:o}=i,r=S(i,["id","label","accept"]);const[u,x]=v.exports.useState(null),[m,l]=v.exports.useState(!1);return w(M,{children:[s("label",{htmlFor:e,className:"leading-8",children:t}),w("div",{className:`relative px-4 py-8 border-dashed border-gray-500 border-4 text-center hover:bg-gray-200 ${m&&"bg-blue-200"}`,children:[u===null?w("div",{children:["Drag file here or"," ",s("span",{className:"text-blue-600 underline",children:"select file"})]}):u,s("input",E(L({type:"file",ref:n,id:e,accept:o},r),{style:{textIndent:"-999em"},onChange:c=>{var g,p;return x(((p=(g=c.target.files)==null?void 0:g[0])==null?void 0:p.name)||null)},onDragEnter:c=>l(!0),onDragLeave:c=>l(!1),onDragEnd:c=>l(!1),onDrop:c=>l(!1),className:"absolute top-0 left-0 w-full h-full cursor-pointer"}))]})]})};var J=v.exports.forwardRef(H);function K(){const e=v.exports.useRef(null);return s("div",{className:"m-4",children:w("form",{onSubmit:o=>{var r;if(o.preventDefault(),((r=e.current)==null?void 0:r.files)&&e.current.files.length){console.log(`Found ${e.current.files.length} files`);const n=e.current.files[0];P(n)}},className:"max-w-lg mx-auto bg-white border-gray-200 border-2 rounded-md p-2",children:[s("legend",{className:"text-xl leading-10",children:"Class Rotation"}),s(J,{id:"original-xl",label:"Original Excel Document",accept:".xlsx",required:!0,ref:e}),s("div",{className:"text-center",children:s("button",{type:"submit",className:"bg-green-600 hover:bg-green-800 text-white p-4 text-center mt-4 mb-2",children:"Create Next Sheet"})})]})})}function W(){return w("div",{className:"App",children:[s(q,{}),s(K,{})]})}I.render(s(U.StrictMode,{children:s(W,{})}),document.getElementById("root"));
