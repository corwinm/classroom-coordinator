var q=Object.defineProperty,K=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var P=(e,t,a)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,H=(e,t)=>{for(var a in t||(t={}))U.call(t,a)&&P(e,a,t[a]);if(R)for(var a of R(t))I.call(t,a)&&P(e,a,t[a]);return e},L=(e,t)=>K(e,_(t));var T=(e,t)=>{var a={};for(var r in e)U.call(e,r)&&t.indexOf(r)<0&&(a[r]=e[r]);if(e!=null&&R)for(var r of R(e))t.indexOf(r)<0&&I.call(e,r)&&(a[r]=e[r]);return a};import{j as $,e as z,r as N,R as G,a as J}from"./vendor.3647ac4e.js";const Q=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const f of n.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function a(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerpolicy&&(n.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?n.credentials="include":l.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(l){if(l.ep)return;l.ep=!0;const n=a(l);fetch(l.href,n)}};Q();const s=$.exports.jsx,y=$.exports.jsxs,V=$.exports.Fragment;function Y(){return s("header",{className:"bg-white border-b-2 border-gray-200",children:s("h1",{className:"text-2xl text-gray-900 py-5 px-4",children:"Classroom Coordinator"})})}function M(e){var t;return((t=e.value)==null?void 0:t.toString().split(" ")[1].split("/").slice(0,2).join("-"))||"N/A"}function Z(e,t,a){return`${e.substring(0,e.indexOf("rotation")+8)} ${t} to ${a}`}const S=24,j=29,B=31,w=2,W=3,v=4,ee="NO SCHOOL";function te(e,{tuesdayHoliday:t,thursdayHoliday:a,noSchoolText:r=ee}){return new Promise((l,n)=>{const f=new FileReader;f.readAsArrayBuffer(e),f.onload=async()=>{if(!f.result||typeof f.result=="string"){n("Failed to load file");return}let h,o;try{h=await new z.exports.Workbook().xlsx.load(f.result),console.log(`Found worksheets: ${h.worksheets.map(i=>i.name)}`),o=h.worksheets.find(i=>i.name.toLowerCase()==="rotation")}catch(u){n("Failed to read Excel doc. Check uploaded document and try again.");return}if(!o){n("Couldn't find worksheet named 'Rotation'");return}o.spliceRows(2,7);let g={[w]:S,[W]:S,[v]:S},p={[w]:j,[W]:j,[v]:j};const c=o.getRows(S,6);for(const u of[w,v]){let i=!1;do i=!1,c==null||c.forEach((A,D)=>{var d;if(i)return;const k=o==null?void 0:o.getCell(D+g[u],u);((d=k==null?void 0:k.value)==null?void 0:d.toString().toUpperCase())===r&&(i=!0,g[u]=g[u]-7,p[u]=p[u]-7)});while(i)}c==null||c.forEach((u,i)=>{var D,k;if(!o){n("Couldn't find worksheet named 'Rotation'");return}const A=o.getRow(i+B);A.height=u.height;for(const d of[w,W,v]){const F=o.getCell(i+g[d],d),b=o.getCell(i+B,d);if(b.style=F.style,[w,v].includes(d)){if(i===0){const x=o.getCell(i+S,d),[O,X]=(k=(D=x.value)==null?void 0:D.toString().split(" "))!=null?k:[],E=new Date(X);E.setDate(E.getDate()+7),b.value=`${O} ${E.toLocaleDateString()}`}else if(d===w&&t||d===v&&a)b.value=i===3?r:"";else if(i===1){let x=0;for(;F.value&&!b.value&&x<5;){const O=o.getCell(p[d]-x,d);b.value=O.value,x+=1}}else if(F.value){const x=o.getCell(i+g[d]-1,d);b.value=x.value}continue}b.value=F.value}});const m=M(o.getCell(3,w)),C=M(o.getCell(B,v));h.title=Z(e.name,m,C),l(h)}})}async function oe(e){const t=await e.xlsx.writeBuffer(),a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=e.title,l.click(),window.URL.revokeObjectURL(r)}const re=(f,n)=>{var h=f,{id:e,label:t,accept:a,onChange:r}=h,l=T(h,["id","label","accept","onChange"]);const[o,g]=N.exports.useState(null),[p,c]=N.exports.useState(!1);return y(V,{children:[s("label",{htmlFor:e,className:"leading-8",children:t}),y("div",{className:`relative px-4 py-8 border-dashed border-gray-500 border-4 text-center hover:bg-gray-200 ${p&&"bg-blue-200"}`,children:[o===null?y("div",{children:["Drag file here or"," ",s("span",{className:"text-blue-600 underline",children:"select a file"})]}):o,s("input",L(H({type:"file",ref:n,id:e,accept:a},l),{style:{textIndent:"-999em"},onChange:m=>{var C,u;g(((u=(C=m.target.files)==null?void 0:C[0])==null?void 0:u.name)||null),r==null||r(m)},onDragEnter:m=>c(!0),onDragLeave:m=>c(!1),onDragEnd:m=>c(!1),onDrop:m=>c(!1),className:"absolute top-0 left-0 w-full h-full cursor-pointer text-transparent"}))]})]})};var ae=N.exports.forwardRef(re);const le=()=>{const[e,t]=N.exports.useState({workbook:null,originalXl:null,tuesdayHoliday:!1,thursdayHoliday:!1}),{tuesdayHoliday:a,thursdayHoliday:r,workbook:l,originalXl:n}=e;return N.exports.useEffect(()=>{(async()=>{if(n)try{const o=await te(n,{tuesdayHoliday:a,thursdayHoliday:r});t(L(H({},e),{workbook:o}))}catch(o){o instanceof Error&&alert(o.message)}})()},[n,a,r]),{formState:e,onSubmit:o=>{o.preventDefault(),l&&oe(l)},onChange:o=>{var c,m;const g=o.target.name||o.target.id;let p;switch(o.target.type){case"file":{p=(m=(c=o.target)==null?void 0:c.files)==null?void 0:m.item(0);break}case"checkbox":p=o.target.checked;break}t(L(H({},e),{[g]:p}))}}};function ne(){const{formState:{workbook:e,tuesdayHoliday:t,thursdayHoliday:a},onChange:r,onSubmit:l}=le();return s("div",{className:"m-4",children:y("form",{onSubmit:l,className:"max-w-lg mx-auto bg-white border-gray-200 border-2 rounded-md p-2",children:[s("legend",{className:"text-xl leading-10",children:"Class Rotation"}),s(ae,{id:"originalXl",label:"Original Excel Document",accept:".xlsx",onChange:r,required:!0}),y("fieldset",{className:"my-2",children:[s("legend",{className:"text-xl leading-10",children:"Holiday?"}),y("div",{children:[s("input",{type:"checkbox",id:"tuesdayHoliday",checked:t,onChange:r}),s("label",{htmlFor:"tuesdayHoliday",className:"mx-1",children:"Tuesday"})]}),y("div",{children:[s("input",{type:"checkbox",id:"thursdayHoliday",checked:a,onChange:r}),s("label",{htmlFor:"thursdayHoliday",className:"mx-1",children:"Thursday"})]})]}),s("div",{className:"text-center",children:y("button",{type:"submit",className:"bg-green-600 hover:bg-green-800 text-white p-4 text-center mt-4 mb-2",children:["Download ",e==null?void 0:e.title]})})]})})}console.log(`Build timestamp: ${new Date("Sun Oct 31 21:18:19 PDT 2021").toLocaleString()}`);function se(){return y("div",{className:"App",children:[s(Y,{}),s(ne,{})]})}G.render(s(J.StrictMode,{children:s(se,{})}),document.getElementById("root"));
